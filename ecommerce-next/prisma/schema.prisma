datasource db {
  provider = "sqlite"
}

generator client {
  provider = "prisma-client-js"
}

enum Role {
  SELLER
  CUSTOMER
}

enum OrderStatus {
  PENDING
  PAID
  SHIPPED
  DELIVERED
  CANCELLED
}

model User {
  id       Int    @id @default(autoincrement())
  name     String
  email    String @unique
  password String
  role     Role   @default(CUSTOMER)

  // Relations
  products  Product[]  @relation("SellerProducts") // products created as seller
  cartItems CartItem[] // items in user's cart
  orders    Order[] // orders placed by user

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
}

model Product {
  id          Int     @id @default(autoincrement())
  title       String
  description String
  price       Float
  discount    Float? // optional discount percentage (0â€“100)
  imageUrl    String?

  // Seller who owns the product
  seller   User @relation("SellerProducts", fields: [sellerId], references: [id])
  sellerId Int

  // Relations
  cartItems  CartItem[] // users who have this in cart
  orderItems OrderItem[] // order items that reference this product

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
}

model CartItem {
  id Int @id @default(autoincrement())

  user   User @relation(fields: [userId], references: [id])
  userId Int

  product   Product @relation(fields: [productId], references: [id])
  productId Int

  quantity Int @default(1)
}

model Order {
  id Int @id @default(autoincrement())

  user   User @relation(fields: [userId], references: [id])
  userId Int

  items  OrderItem[]
  total  Float
  status OrderStatus @default(PENDING)

  createdAt DateTime @default(now())
  // uncomment if you want:
  // updatedAt DateTime @updatedAt
}

model OrderItem {
  id Int @id @default(autoincrement())

  order   Order @relation(fields: [orderId], references: [id])
  orderId Int

  product   Product @relation(fields: [productId], references: [id])
  productId Int

  price    Float // snapshot price at time of order
  quantity Int
}
